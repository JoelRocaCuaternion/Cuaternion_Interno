<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visor Autodesk</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./main.css" />
    <link rel="icon" type="image/x-icon" href="./bonareaLogoico.ico" />
    <link rel="stylesheet" href="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/style.min.css" type="text/css">
</head>
<body>
    <!-- Visor 3D -->
    <div class="viewer" id="viewerContainer">
        <div id="preview2D"></div>
    </div>

    <!-- Menú lateral izquierdo -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <img src="./Bonarea-logo-1.png" height="100px" alt="Bon Area" />
        </div>
        
        <a href="#" class="sidebar-item">
            <i class='bx bx-layer'></i>
            <span>Panell</span>
        </a>
        
        <a href="models.html" class="sidebar-item">
            <i class='bx bx-cube'></i>
            <span>Models</span>
        </a>
        
        <a href="#" class="sidebar-item">
            <i class='bx bx-map'></i>
            <span>Mapes</span>
        </a>
        
        <a href="#" class="sidebar-item">
            <i class='bx bx-user'></i>
            <span>El meu perfil</span>
        </a>
        
        <a href="index.html" class="sidebar-item">
            <i class='bx bx-desktop'></i>
            <span>Visor 3D</span>
        </a>

        <a href="#" class="sidebar-item active">
            <i class='bx bx-desktop'></i>
            <span>P&ID</span>
        </a>

        <a href="#" class="sidebar-item">
            <i class='bx bx-desktop'></i>
            <span>Dual</span>
        </a>
    </div>

    <button class="sidebar-toggle sidebar-visible" id="sidebarToggle" onclick="toggleSidebar()">
        <i class='bx bx-chevron-left' id="sidebarToggleIcon"></i>
    </button>

    <!-- Panel desplegable P -->
    <div class="collapsible-panel" id="collapsiblePanelP">
        <div class="panel-content">
            <div class="panel-header">
                <div class="panel-title">P</div>
                <div class="cards-container">
                    <div class="status-card">
                        <div class="status-card-header">N1</div>
                        <div class="status-content">
                            <div class="status-icon info">
                                <i class='bx bx-check'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N2</div>
                        <div class="status-content">
                            <div class="status-icon warning">
                                <i class='bx bx-exclamation'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N3</div>
                        <div class="status-content">
                            <div class="status-icon error">
                                <i class='bx bx-x'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N4</div>
                        <div class="status-content">
                            <div class="status-icon success">
                                <i class='bx bx-check'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N5</div>
                        <div class="status-content">
                            <div class="status-icon purple">
                                <i class='bx bx-cog'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N6</div>
                        <div class="status-content">
                            <div class="status-icon orange">
                                <i class='bx bx-time'></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="toggle-button" onclick="togglePanelP()">
            <i class='bx bx-chevron-up' id="toggleIconP"></i>
        </button>
    </div>

    <!-- Panel desplegable A -->
    <div class="collapsible-panel-a" id="collapsiblePanelA">
        <div class="panel-content">
            <div class="panel-header">
                <div class="panel-title">A</div>
                <div class="cards-container">
                    <div class="status-card">
                        <div class="status-card-header">N1</div>
                        <div class="status-content">
                            <div class="status-icon success">
                                <i class='bx bx-check'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N2</div>
                        <div class="status-content">
                            <div class="status-icon info">
                                <i class='bx bx-info-circle'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N3</div>
                        <div class="status-content">
                            <div class="status-icon warning">
                                <i class='bx bx-exclamation'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N4</div>
                        <div class="status-content">
                            <div class="status-icon error">
                                <i class='bx bx-x'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N5</div>
                        <div class="status-content">
                            <div class="status-icon purple">
                                <i class='bx bx-cog'></i>
                            </div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-card-header">N6</div>
                        <div class="status-content">
                            <div class="status-icon orange">
                                <i class='bx bx-time'></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="toggle-button" onclick="togglePanelA()">
            <i class='bx bx-chevron-up' id="toggleIconA"></i>
        </button>
    </div>

    <!-- Pestañas flotantes -->
    <div class="floating-tabs" id="floatingTabs">
        <button class="floating-tab" onclick="showPanelP()">P</button>
        <button class="floating-tab" onclick="showPanelA()">A</button>
    </div>


    <div id="overlay" style="display:none;">
        <div class="notification">
        <button id="closeOverlay" aria-label="Cerrar overlay" 
        style="position:absolute; top:10px; right:15px; border:none; background:none; font-size:1.5em; cursor:pointer;">×</button>
      <div id="notificationContent"></div>
        </div>
    </div>

    <script src="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/viewer3D.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
     <script>
        let sidebarVisible = true;
        let panelPVisible = false;
        let panelAVisible = false;

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebarToggleIcon = document.getElementById('sidebarToggleIcon');
            const panelP = document.getElementById('collapsiblePanelP');
            const panelA = document.getElementById('collapsiblePanelA');
            const floatingTabs = document.getElementById('floatingTabs');
            
            sidebarVisible = !sidebarVisible;
            
            if (sidebarVisible) {
                sidebar.classList.remove('collapsed');
                sidebarToggle.classList.add('sidebar-visible');
                sidebarToggleIcon.className = 'bx bx-chevron-left';
                panelP.classList.remove('sidebar-hidden');
                panelA.classList.remove('sidebar-hidden');
                floatingTabs.classList.remove('sidebar-hidden');
            } else {
                sidebar.classList.add('collapsed');
                sidebarToggle.classList.remove('sidebar-visible');
                sidebarToggleIcon.className = 'bx bx-chevron-right';
                panelP.classList.add('sidebar-hidden');
                panelA.classList.add('sidebar-hidden');
                floatingTabs.classList.add('sidebar-hidden');
            }
        }

        function togglePanelP() {
            const panelP = document.getElementById('collapsiblePanelP');
            const iconP = document.getElementById('toggleIconP');
            const floatingTabs = document.getElementById('floatingTabs');
            
            panelPVisible = !panelPVisible;
            
            if (panelPVisible) {
                panelP.classList.add('show');
                iconP.className = 'bx bx-chevron-up';
                floatingTabs.classList.add('hidden');
            } else {
                panelP.classList.remove('show');
                iconP.className = 'bx bx-chevron-down';
                if (!panelAVisible) {
                    floatingTabs.classList.remove('hidden');
                }
            }
        }

        function togglePanelA() {
            const panelA = document.getElementById('collapsiblePanelA');
            const iconA = document.getElementById('toggleIconA');
            const floatingTabs = document.getElementById('floatingTabs');
            
            panelAVisible = !panelAVisible;
            
            if (panelAVisible) {
                panelA.classList.add('show');
                iconA.className = 'bx bx-chevron-up';
                floatingTabs.classList.add('hidden');
            } else {
                panelA.classList.remove('show');
                iconA.className = 'bx bx-chevron-down';
                if (!panelPVisible) {
                    floatingTabs.classList.remove('hidden');
                }
            }
        }

        function showPanelP() {
            // Cerrar panel A si está abierto
            if (panelAVisible) {
                togglePanelA();
            }
            // Abrir panel P
            if (!panelPVisible) {
                togglePanelP();
            }
        }

        function showPanelA() {
            // Cerrar panel P si está abierto
            if (panelPVisible) {
                togglePanelP();
            }
            // Abrir panel A
            if (!panelAVisible) {
                togglePanelA();
            }
        }

        // Funcionalidad del menú lateral
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.addEventListener('click', function(e) {
                const href = this.getAttribute('href');
                if (href === '#') {
                    e.preventDefault();
                }

                document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Cerrar overlay
        document.getElementById('closeOverlay').addEventListener('click', function() {
            document.getElementById('overlay').style.display = 'none';
        });
    </script>

    </script>
    <script type="module" src="./main.js"></script>
    <script type="module" src="./viewer.js"></script>
</body>
</html>